(()=>{var t={483:t=>{t.exports=function(t){function e(t){let e=[];const s=t.split("\n").filter((t=>t&&"\n"!==t)),i=/(^.\d*)\.\s(.*)\s~\s(.*)/;for(let t=0;t<s.length;t++){if(!s[t].trim())continue;const r=s[t].match(i);if(4!==r.length)throw`Could not parse question ${s[t]}`;const o=r[2].replace(/\\/g,"");e[t]={num:r[1],question:o,answer:r[3]}}return e}return function(t){let s=t.split(/^$^$/gm).filter((t=>"\n"!==t));if(s.length>4){s=t.split(/\r\n\r\n/g).filter((t=>t.trim()));for(let t=0;t<s.length;t++)s[t]=s[t].replace(/\r\n/g,"\n")}if(4!==s.length)throw`Too many parts - expected 4, found ${s.length}`;const i=s[0],r=s[1],o=s[2],n=s[3],a=function(t){const e=t.split("\n").filter((t=>t&&"\n"!==t));let s={};return e.forEach((t=>{const e=t.split(": ");s[e[0]]=e[1]})),s}(i),l=function(t){let e=[];const s=t.split("\n").filter((t=>t&&"\n"!==t));for(let t=0;t<s.length;t++)e[t]=s[t].split("");return e}(r);return{meta:a,grid:l,across:e(o),down:e(n),rawGrid:r,rawAcross:o,rawDown:n,rawMeta:i}}(t)}}},e={};function s(i){var r=e[i];if(void 0!==r)return r.exports;var o=e[i]={exports:{}};return t[i](o,o.exports,s),o.exports}s.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return s.d(e,{a:e}),e},s.d=(t,e)=>{for(var i in e)s.o(e,i)&&!s.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";function t(t){return Math.abs(Math.floor(t))}function e(t,e){return Math.random()*(e-t)+t}function i(t,s){return Math.floor(e(t,s+1))}function r(t,e,s,i){const r=Math.pow;return Math.sqrt(r(t-s,2)+r(e-i,2))}function o(t,e,s=1){if(t>360||t<0)throw new Error(`Expected hue 0-360 range, got \`${t}\``);if(e>100||e<0)throw new Error(`Expected lightness 0-100 range, got \`${e}\``);if(s>1||s<0)throw new Error(`Expected alpha 0-1 range, got \`${s}\``);return`hsla(${t}, 100%, ${e}%, ${s})`}const n=t=>{if("object"==typeof t&&null!==t){if("function"==typeof Object.getPrototypeOf){const e=Object.getPrototypeOf(t);return e===Object.prototype||null===e}return"[object Object]"===Object.prototype.toString.call(t)}return!1},a=["__proto__","constructor","prototype"],l=(...t)=>t.reduce(((t,e)=>(Object.keys(e).forEach((s=>{a.includes(s)||(Array.isArray(t[s])&&Array.isArray(e[s])?t[s]=e[s]:n(t[s])&&n(e[s])?t[s]=l(t[s],e[s]):t[s]=e[s])})),t)),{});class h{x;y;ctx;hue;friction;gravity;flickering;lineWidth;explosionLength;angle;speed;brightness;coordinates=[];decay;alpha=1;constructor({x:t,y:s,ctx:r,hue:o,decay:n,gravity:a,friction:l,brightness:h,flickering:c,lineWidth:d,explosionLength:u}){for(this.x=t,this.y=s,this.ctx=r,this.hue=o,this.gravity=a,this.friction=l,this.flickering=c,this.lineWidth=d,this.explosionLength=u,this.angle=e(0,2*Math.PI),this.speed=i(1,10),this.brightness=i(h.min,h.max),this.decay=e(n.min,n.max);this.explosionLength--;)this.coordinates.push([t,s])}update(t){this.coordinates.pop(),this.coordinates.unshift([this.x,this.y]),this.speed*=this.friction,this.x+=Math.cos(this.angle)*this.speed,this.y+=Math.sin(this.angle)*this.speed+this.gravity,this.alpha-=this.decay,this.alpha<=this.decay&&t()}draw(){const t=this.coordinates.length-1;this.ctx.beginPath(),this.ctx.lineWidth=this.lineWidth,this.ctx.fillStyle=o(this.hue,this.brightness,this.alpha),this.ctx.moveTo(this.coordinates[t][0],this.coordinates[t][1]),this.ctx.lineTo(this.x,this.y),this.ctx.strokeStyle=o(this.hue,this.flickering?e(0,this.brightness):this.brightness,this.alpha),this.ctx.stroke()}}class c{constructor(t,e){this.options=t,this.canvas=e,this.pointerDown=this.pointerDown.bind(this),this.pointerUp=this.pointerUp.bind(this),this.pointerMove=this.pointerMove.bind(this)}active=!1;x;y;get mouseOptions(){return this.options.mouse}mount(){this.canvas.addEventListener("pointerdown",this.pointerDown),this.canvas.addEventListener("pointerup",this.pointerUp),this.canvas.addEventListener("pointermove",this.pointerMove)}unmount(){this.canvas.removeEventListener("pointerdown",this.pointerDown),this.canvas.removeEventListener("pointerup",this.pointerUp),this.canvas.removeEventListener("pointermove",this.pointerMove)}usePointer(t,e){const{click:s,move:i}=this.mouseOptions;(s||i)&&(this.x=t.pageX-this.canvas.offsetLeft,this.y=t.pageY-this.canvas.offsetTop,this.active=e)}pointerDown(t){this.usePointer(t,this.mouseOptions.click)}pointerUp(t){this.usePointer(t,!1)}pointerMove(t){this.usePointer(t,this.active)}}class d{hue;rocketsPoint;opacity;acceleration;friction;gravity;particles;explosion;mouse;boundaries;sound;delay;brightness;decay;flickering;intensity;traceLength;traceSpeed;lineWidth;lineStyle;autoresize;constructor(){this.autoresize=!0,this.lineStyle="round",this.flickering=50,this.traceLength=3,this.traceSpeed=10,this.intensity=30,this.explosion=5,this.gravity=1.5,this.opacity=.5,this.particles=50,this.friction=.95,this.acceleration=1.05,this.hue={min:0,max:360},this.rocketsPoint={min:50,max:50},this.lineWidth={explosion:{min:1,max:3},trace:{min:1,max:2}},this.mouse={click:!1,move:!1,max:1},this.delay={min:30,max:60},this.brightness={min:50,max:80},this.decay={min:.015,max:.03},this.sound={enabled:!1,files:["explosion0.mp3","explosion1.mp3","explosion2.mp3"],volume:{min:4,max:8}},this.boundaries={debug:!1,height:0,width:0,x:50,y:50}}update(t){Object.assign(this,l(this,t))}}class u{constructor(t,e){this.options=t,this.render=e}tick=0;rafId=0;fps=60;tolerance=.1;now;mount(){this.now=performance.now();const t=1e3/this.fps,e=s=>{this.rafId=requestAnimationFrame(e);const i=s-this.now;i>=t-this.tolerance&&(this.render(),this.now=s-i%t,this.tick+=i*(this.options.intensity*Math.PI)/1e3)};this.rafId=requestAnimationFrame(e)}unmount(){cancelAnimationFrame(this.rafId)}}class w{constructor(t,e,s){this.options=t,this.updateSize=e,this.container=s}resizer;mount(){if(!this.resizer){const t=function(t,e){let s;return(...i)=>{s&&clearTimeout(s),s=setTimeout((()=>t(...i)),e)}}((()=>this.updateSize()),100);this.resizer=new ResizeObserver(t)}this.options.autoresize&&this.resizer.observe(this.container)}unmount(){this.resizer&&this.resizer.unobserve(this.container)}}class p{constructor(t){this.options=t,this.init()}buffers=[];audioContext;onInit=!1;get isEnabled(){return this.options.sound.enabled}get soundOptions(){return this.options.sound}init(){!this.onInit&&this.isEnabled&&(this.onInit=!0,this.audioContext=new(window.AudioContext||window.webkitAudioContext),this.loadSounds())}async loadSounds(){for(const t of this.soundOptions.files){const e=await(await fetch(t)).arrayBuffer();this.audioContext.decodeAudioData(e).then((t=>{this.buffers.push(t)})).catch((t=>{throw t}))}}play(){if(this.isEnabled&&this.buffers.length){const t=this.audioContext.createBufferSource(),s=this.buffers[i(0,this.buffers.length-1)],r=this.audioContext.createGain();t.buffer=s,r.gain.value=e(this.soundOptions.volume.min/100,this.soundOptions.volume.max/100),r.connect(this.audioContext.destination),t.connect(r),t.start(0)}else this.init()}}class m{x;y;sx;sy;dx;dy;ctx;hue;speed;acceleration;traceLength;totalDistance;angle;brightness;coordinates=[];currentDistance=0;constructor({x:t,y:e,dx:s,dy:o,ctx:n,hue:a,speed:l,traceLength:h,acceleration:c}){for(this.x=t,this.y=e,this.sx=t,this.sy=e,this.dx=s,this.dy=o,this.ctx=n,this.hue=a,this.speed=l,this.traceLength=h,this.acceleration=c,this.totalDistance=r(t,e,s,o),this.angle=Math.atan2(o-e,s-t),this.brightness=i(50,70);this.traceLength--;)this.coordinates.push([t,e])}update(t){this.coordinates.pop(),this.coordinates.unshift([this.x,this.y]),this.speed*=this.acceleration;const e=Math.cos(this.angle)*this.speed,s=Math.sin(this.angle)*this.speed;this.currentDistance=r(this.sx,this.sy,this.x+e,this.y+s),this.currentDistance>=this.totalDistance?t(this.dx,this.dy,this.hue):(this.x+=e,this.y+=s)}draw(){const t=this.coordinates.length-1;this.ctx.beginPath(),this.ctx.moveTo(this.coordinates[t][0],this.coordinates[t][1]),this.ctx.lineTo(this.x,this.y),this.ctx.strokeStyle=o(this.hue,this.brightness),this.ctx.stroke()}}class x{target;container;canvas;ctx;width;height;traces=[];explosions=[];waitStopRaf;running=!1;opts;sound;resize;mouse;raf;constructor(t,e={}){this.target=t,this.container=t,this.opts=new d,this.createCanvas(this.target),this.updateOptions(e),this.sound=new p(this.opts),this.resize=new w(this.opts,this.updateSize.bind(this),this.container),this.mouse=new c(this.opts,this.canvas),this.raf=new u(this.opts,this.render.bind(this))}get isRunning(){return this.running}get version(){return"2.10.7"}get currentOptions(){return this.opts}start(){this.running||(this.canvas.isConnected||this.createCanvas(this.target),this.running=!0,this.resize.mount(),this.mouse.mount(),this.raf.mount())}stop(t=!1){!this.running||(this.running=!1,this.resize.unmount(),this.mouse.unmount(),this.raf.unmount(),this.clear(),t&&this.canvas.remove())}async waitStop(t){if(this.running)return new Promise((e=>{this.waitStopRaf=()=>{!this.waitStopRaf||(requestAnimationFrame(this.waitStopRaf),!this.traces.length&&!this.explosions.length&&(this.waitStopRaf=null,this.stop(t),e()))},this.waitStopRaf()}))}pause(){this.running=!this.running,this.running?this.raf.mount():this.raf.unmount()}clear(){!this.ctx||(this.traces=[],this.explosions=[],this.ctx.clearRect(0,0,this.width,this.height))}launch(t=1){for(let e=0;e<t;e++)this.createTrace();this.waitStopRaf||(this.start(),this.waitStop())}updateOptions(t){this.opts.update(t)}updateSize({width:t=this.container.clientWidth,height:e=this.container.clientHeight}={}){this.width=t,this.height=e,this.canvas.width=t,this.canvas.height=e,this.updateBoundaries({...this.opts.boundaries,width:t,height:e})}updateBoundaries(t){this.updateOptions({boundaries:t})}createCanvas(t){t instanceof HTMLCanvasElement?(t.isConnected||document.body.append(t),this.canvas=t):(this.canvas=document.createElement("canvas"),this.container.append(this.canvas)),this.ctx=this.canvas.getContext("2d"),this.updateSize()}render(){if(!this.ctx||!this.running)return;const{opacity:t,lineStyle:s,lineWidth:i}=this.opts;this.ctx.globalCompositeOperation="destination-out",this.ctx.fillStyle=`rgba(0, 0, 0, ${t})`,this.ctx.fillRect(0,0,this.width,this.height),this.ctx.globalCompositeOperation="lighter",this.ctx.lineCap=s,this.ctx.lineJoin="round",this.ctx.lineWidth=e(i.trace.min,i.trace.max),this.initTrace(),this.drawTrace(),this.drawExplosion()}createTrace(){const{hue:e,rocketsPoint:s,boundaries:r,traceLength:o,traceSpeed:n,acceleration:a,mouse:l}=this.opts;this.traces.push(new m({x:this.width*i(s.min,s.max)/100,y:this.height,dx:this.mouse.x&&l.move||this.mouse.active?this.mouse.x:i(r.x,r.width-2*r.x),dy:this.mouse.y&&l.move||this.mouse.active?this.mouse.y:i(r.y,.5*r.height),ctx:this.ctx,hue:i(e.min,e.max),speed:n,acceleration:a,traceLength:t(o)}))}initTrace(){if(this.waitStopRaf)return;const{delay:t,mouse:e}=this.opts;(this.raf.tick>i(t.min,t.max)||this.mouse.active&&e.max>this.traces.length)&&(this.createTrace(),this.raf.tick=0)}drawTrace(){let t=this.traces.length;for(;t--;)this.traces[t].draw(),this.traces[t].update(((e,s,i)=>{this.initExplosion(e,s,i),this.sound.play(),this.traces.splice(t,1)}))}initExplosion(s,r,o){const{particles:n,flickering:a,lineWidth:l,explosion:c,brightness:d,friction:u,gravity:w,decay:p}=this.opts;let m=t(n);for(;m--;)this.explosions.push(new h({x:s,y:r,ctx:this.ctx,hue:o,friction:u,gravity:w,flickering:i(0,100)<=a,lineWidth:e(l.explosion.min,l.explosion.max),explosionLength:t(c),brightness:d,decay:p}))}drawExplosion(){let t=this.explosions.length;for(;t--;)this.explosions[t].draw(),this.explosions[t].update((()=>{this.explosions.splice(t,1)}))}}const v=class{constructor(t){if(console.log("JXWord, a crossword system by Jason Norwood-Young <jason@10layer.com>"),this.product_name="JXWord",window.jxword_product_name&&(this.product_name=window.jxword_product_name),!t.container)throw"'container' required";if(!t.data)throw"'data' required";this.opts=Object.assign({width:500,height:500,outerBorderWidth:1.5,innerBorderWidth:1,margin:3,outerBorderColour:"black",innerBorderColour:"black",fillColour:"black",cols:t.data.grid.length,rows:t.data.grid[0].length,fontRatio:.8,numRatio:.25,selectCellColour:"#f7f457",selectWordColour:"#9ce0fb",backgroundColour:"white",debug:!1,restoreState:!1,progress:0,quartile:0},t),window.jxword_completed_audio&&(this.opts.completeAudio=window.jxword_completed_audio),this.uid=+new Date,this.state={time_taken:0,autocheck:!1,cheated:!1},this.across_questions=[],this.down_questions=[],this.is_hidden=!1,this.is_paused=!1,this.last_quartile=0,this.opts.completeAudio?this.audio=new Audio(this.opts.completeAudio):this.audio=null,document.addEventListener("DOMContentLoaded",this.onLoad.bind(this))}onLoad(){if(this.containerElement=document.querySelector(this.opts.container),!this.containerElement)throw`Could not find ${this.opts.container}`;this.totalWidth=this.opts.width+2*this.opts.margin,this.totalHeight=this.opts.height+2*this.opts.margin,this.cellWidth=this.opts.width/this.opts.cols,this.cellHeight=this.opts.height/this.opts.rows,this.fontSize=this.cellWidth*this.opts.fontRatio,this.grid=[],this.grid=this.opts.data.grid[0].map(((t,e)=>this.opts.data.grid.map((t=>t[e])))),this.hash=this.calcHash(this.grid),this.storageName=`jxword-${Math.abs(this.hash)}`,this.drawLayout(),this.drawGrid(),this.drawBorder(),this.drawNumbers(),this.drawQuestions(),this.restoreState(),this.setAria(),this.registerActions(),this.setFocus(),this.listenQuestions(),this.setTimer(),this.drawTimer(),this.checkOverlay(),this.state.complete&&this.displayWin(),this.setupIOSKeyboard(),this.containerElement.dispatchEvent(new CustomEvent("jxword:load",{detail:this.state}))}setTimer(){setInterval((()=>{this.is_hidden||this.is_paused||this.state.complete||(this.state.time_taken||(this.state.time_taken=0),this.state.time_taken++,this.saveState(),this.drawTimer())}).bind(this),1e3)}drawLayout(){this.containerElement.innerHTML=`\n        <div class="jxword-container" id="jxword-container-${this.uid}">\n            <div id="jxword-overlay-${this.uid}" class="jxword-overlay jxword-overlay-hidden">\n                <div class="jxword-overlay-content">\n                    <div id="jxword-paused-${this.uid}" class="jxword-paused">\n                        <div class="jxword-overlay-title">\n                            Your Game is Currently Paused\n                        </div>\n                        <div id="jxword-overlay-resume-${this.uid}" class="jxword-overlay-button">\n                            Resume\n                        </div>\n                    </div>\n                    <div id="jxword-complete_overlay-${this.uid}" class="jxword-complete_overlay">\n                        <div class="jxword-overlay-title">\n                            Congratulations! You've Won!\n                        </div>\n                        <div class="jxword-overlay-time" id="jxword-overlay_time-${this.uid}"></div>\n                        <div id="jxword-overlay_share-${this.uid}" class="jxword-overlay-share"></div>\n                        <div id="jxword-overlay-restart-${this.uid}" class="jxword-overlay-button jxword-reset">\n                            Restart\n                        </div>\n                        <div class="jxword-overlay-button jxword-close-overlay">\n                            Close\n                        </div>\n                    </div>\n                    <div id="jxword-meta_overlay-${this.uid}" class="jxword-meta_overlay">\n                        <div class="jxword-overlay-title">\n                            ${this.opts.data.meta.Title}\n                        </div>\n                        <div class="jxword-overlay-text">\n                            <ul>\n                                ${Object.keys(this.opts.data.meta).map((t=>"Title"===t?"":`<li>${t}:\n                                    ${this.opts.data.meta[t]}</li>`)).join("\n")}\n                            </ul>\n                        </div>\n                        <div class="jxword-overlay-button jxword-close-overlay">\n                            Close\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div class="jxword-play-area">\n                <div class="jxword-grid-container">\n                    <div class="jxword-header">\n                        <nav class="jxword-controls" role="navigation">\n                            <div class="jxword-menu-toggle">\n                                <input type="checkbox" />\n                                <span class="jxword-hamberder"></span>\n                                <span class="jxword-hamberder"></span>\n                                <span class="jxword-hamberder"></span>\n                                <ul class="jxword-menu">\n                                    <a href="#" aria-label="About This Puzzle" class="jxword-button"\n                                        id="jxword-meta-${this.uid}">\n                                        <li>About This Puzzle</li>\n                                    </a>\n                                    <li class="jxword-menu-break">\n                                        <hr>\n                                    </li>\n                                    <a href="#" aria-label="Toggle Autocheck" class="jxword-button"\n                                        id="jxword-autocheck-${this.uid}">\n                                        <li>Autocheck</li>\n                                    </a>\n                                    <a href="#" aria-label="Check Square" class="jxword-button"\n                                        id="jxword-check_square-${this.uid}">\n                                        <li>Check Square</li>\n                                    </a>\n                                    <a href="#" aria-label="Check Puzzle" class="jxword-button"\n                                        id="jxword-check_word-${this.uid}">\n                                        <li>Check Word</li>\n                                    </a>\n                                    <a href="#" aria-label="Check Puzzle" class="jxword-button"\n                                        id="jxword-check_puzzle-${this.uid}">\n                                        <li>Check Puzzle</li>\n                                    </a>\n                                    <li class="jxword-menu-break">\n                                        <hr>\n                                    </li>\n                                    <a href="#" aria-label="Print (Blank)" class="jxword-button"\n                                        id="jxword-print_blank-${this.uid}">\n                                        <li>Print (Blank)</li>\n                                    </a>\n                                    <a href="#" aria-label="Print (Filled)" class="jxword-button"\n                                        id="jxword-print_filled-${this.uid}">\n                                        <li>Print (Filled)</li>\n                                    </a>\n                                    <li class="jxword-menu-break">\n                                        <hr>\n                                    </li>\n                                    <a href="#" aria-label="Reset Puzzle" class="jxword-button jxword-reset"\n                                        id="jxword-reset-${this.uid}">\n                                        <li>Reset</li>\n                                    </a>\n                                </ul>\n                            </div>\n                        </nav>\n                        <div id="jxword-pause-${this.uid}" class="jxword-pause">\n                            <span class="jxword-pause-text jxword-sr-only">Pause</span>\n                        </div>\n                        <div id="jxword-timer-${this.uid}" class="jxword-timer"></div>\n                    </div>\n                    <div class="jxword-svg-container">\n                        <svg id='jxword-svg-${this.uid}' class='jxword-svg'\n                            viewBox="0 0 ${this.totalWidth} ${this.totalHeight}">\n                            <g class="cell-group" id='jxword-g-container-${this.uid}'></g>\n                        </svg>\n                    </div>\n                    <div class="jxword-single-question-container jxword-mobile-only">\n                        <div class="jxword-arrow jxword-arrow-back" id="jxword-arrow-back-${this.uid}">&lang;</div>\n                        <div class="jxword-single-question" id="jxword-single-question-${this.uid}"></div>\n                        <div class="jxword-arrow jxword-arrow-forward" id="jxword-arrow-forward-${this.uid}">&rang;</div>\n                    </div>\n                    <div class="jxword-keyboard jxword-mobile-only">\n                        <div class="jxword-keyboard-row">\n                            <div class="jxword-key" data-key="Q">Q</div>\n                            <div class="jxword-key" data-key="W">W</div>\n                            <div class="jxword-key" data-key="E">E</div>\n                            <div class="jxword-key" data-key="R">R</div>\n                            <div class="jxword-key" data-key="T">T</div>\n                            <div class="jxword-key" data-key="Y">Y</div>\n                            <div class="jxword-key" data-key="U">U</div>\n                            <div class="jxword-key" data-key="I">I</div>\n                            <div class="jxword-key" data-key="O">O</div>\n                            <div class="jxword-key" data-key="P">P</div>\n                        </div>\n                        <div class="jxword-keyboard-row">\n                            <div class="jxword-key" data-key="A">A</div>\n                            <div class="jxword-key" data-key="S">S</div>\n                            <div class="jxword-key" data-key="D">D</div>\n                            <div class="jxword-key" data-key="F">F</div>\n                            <div class="jxword-key" data-key="G">G</div>\n                            <div class="jxword-key" data-key="H">H</div>\n                            <div class="jxword-key" data-key="J">J</div>\n                            <div class="jxword-key" data-key="K">K</div>\n                            <div class="jxword-key" data-key="L">L</div>\n                        </div>\n                        <div class="jxword-keyboard-row">\n                            <div class="jxword-key" data-key="Z">Z</div>\n                            <div class="jxword-key" data-key="X">X</div>\n                            <div class="jxword-key" data-key="C">C</div>\n                            <div class="jxword-key" data-key="V">V</div>\n                            <div class="jxword-key" data-key="B">B</div>\n                            <div class="jxword-key" data-key="N">N</div>\n                            <div class="jxword-key" data-key="M">M</div>\n                            <div class="jxword-key jxword-key-backspace" data-key="BACKSPACE">&lArr;</div>\n                        </div>\n                    </div>\n                </div>\n                <div class="jxword-question-container jxword-desktop-only" id="jxword-question-container-${this.uid}">\n                    <div class="jxword-questions-across" id="jxword-question-across-${this.uid}">\n                        <h4>Across</h4>\n                    </div>\n                    <div class="jxword-questions-down" id="jxword-question-down-${this.uid}">\n                        <h4>Down</h4>\n                    </div>\n                </div>\n            </div>\n        </div>\n        `,this.svg=document.querySelector(`#jxword-svg-${this.uid}`),this.cellGroup=document.querySelector(`#jxword-g-container-${this.uid}`)}drawGrid(){for(let t=0;t<this.opts.rows;t++)for(let e=0;e<this.opts.cols;e++)this.cellGroup.innerHTML+=this.drawCell(this.grid[e][t],e,t)}drawCell(t,e,s){const i=this.cellWidth*e+this.opts.margin,r=this.cellHeight*s+this.opts.margin,o=this.cellWidth,n=this.cellHeight,a=i+o/2,l=r+this.fontSize-this.opts.margin;let h=this.opts.backgroundColour,c="is-letter",d="is-letter-container";return"#"==t&&(h=this.opts.fillColour,c="is-blank",d=""),`<g id="jxword-cell-${this.uid}-${e}-${s}" class="jxword-cell ${d}" style="z-index: 20"><rect class="jxword-cell-rect ${c}" role="cell" tabindex="-1" aria-label="" x="${i}" y="${r}" width="${o}" height="${n}" stroke="${this.opts.innerBorderColour}" stroke-width="${this.opts.innerBorderWidth}" fill="${h}" data-col="${e}" data-row="${s}" contenteditable="true"></rect><text id="jxword-letter-${this.uid}-${e}-${s}" class="jxword-letter" x="${a}" y="${l}" text-anchor="middle" font-size="${this.fontSize}" width="${o}"></text></g>`}drawLetter(t,e,s){const i=document.querySelector(`#jxword-letter-${this.uid}-${e}-${s}`);this.state.correctGrid[e][s]?i.classList.add("jxword-letter-is-correct"):i.classList.remove("jxword-letter-is-correct");const r=document.createTextNode(t);for(;i.firstChild;)i.removeChild(i.lastChild);i.appendChild(r)}drawTimer(){var t,e,s,i,r;document.querySelector(`#jxword-timer-${this.uid}`).innerHTML=`<span id="jxword-timer-text-${this.uid}">${t=this.state.time_taken,e=parseInt(t,10),s=Math.floor(e/3600),i=Math.floor((e-3600*s)/60),r=e-3600*s-60*i,s<10&&(s="0"+s),i<10&&(i="0"+i),r<10&&(r="0"+r),s+":"+i+":"+r}</span>`}humanTime(){const t=this.state.time_taken,e=Math.floor(t/60),s=Math.floor(e/60),i=t-60*e,r=e-60*s,o=1==i?"":"s",n=1==r?"":"s";return 0==s&&0==e?`${t} second${o}`:0==s?`${e} minute${n} and ${i} second${o}`:`${s} hour${1==s?"":"s"}, ${r} minute${n} and ${i} second${o}`}drawShare(){const t=encodeURIComponent(this.product_name);let e=new URLSearchParams(window.location.search).get("share_url");e||(e=window.location.href);const s=this.humanTime(this.state.time_taken),i=encodeURIComponent(s),r=`\n        <div class="jxword-overlay-share-option jxword-overlay-share-option-clipboard" data-text="I%20just%20completed%20the%20${t}%20in%20${i}!%20Can%20you%20beat%20my%20time? ${encodeURIComponent(e)}">\n            <span class="dashicons dashicons-clipboard"></span>&nbsp;&nbsp;Copy your results\n        </div>\n        <div class="jxword-overlay-share-option">\n            <a href="https://twitter.com/intent/tweet?text=I%20just%20completed%20the%20${t}%20in%20${i}!%20Can%20you%20beat%20my%20time?&url=${encodeURIComponent(e)}" target="_blank"><span class="dashicons dashicons-twitter"></span> Share your results on Twitter</a>\n        </div>\n        <div class="jxword-overlay-share-option">\n            <a href="whatsapp://send?text=I%20just%20completed%20the%20${t}%20in%20${i}!%20Can%20you%20beat%20my%20time?%20${encodeURIComponent(e)}" target="_blank"><span class="dashicons dashicons-whatsapp"></span> Share your results on WhatsApp</a>\n        </div>`;document.querySelector(`#jxword-overlay_share-${this.uid}`).innerHTML=r;document.querySelector(`#jxword-overlay_time-${this.uid}`).innerHTML=`Your time: ${this.humanTime(this.state.time_taken)}`,document.querySelector(".jxword-overlay-share-option-clipboard").addEventListener("click",this.copyToClipboard.bind(this))}isStartOfAcross(t,e){return 0===t&&"#"!==this.grid[t][e]&&"#"!==this.grid[t+1][e]||"#"!==this.grid[t][e]&&(!!this.grid[t+1]&&(0===t||"#"==this.grid[t-1][e]))}isStartOfDown(t,e){return"#"!==this.grid[t][e]&&(!!this.grid[t][e+1]&&(0===e||"#"==this.grid[t][e-1]))}drawNumbers(){let t=1;for(let e=0;e<this.opts.rows;e++)for(let s=0;s<this.opts.cols;s++){let i=!1;this.isStartOfAcross(s,e)&&s!==this.opts.cols-1&&"#"!==this.grid[s+1][e]&&(i=!0,this.across_questions.push({num:t,col:s,row:e,data:this.opts.data.across.find((e=>e.num===`A${t}`))})),this.isStartOfDown(s,e)&&e!==this.opts.rows-1&&"#"!==this.grid[s][e+1]&&(i=!0,this.down_questions.push({num:t,col:s,row:e,data:this.opts.data.down.find((e=>e.num===`D${t}`))})),i&&this.drawNumber(s,e,t++)}}drawNumber(t,e,s){const i=this.cellWidth*this.opts.numRatio,r=this.cellWidth*t+this.opts.margin+.04*this.cellWidth,o=this.cellHeight*e+this.opts.margin-.02*this.cellWidth+i;document.querySelector(`#jxword-cell-${this.uid}-${t}-${e}`).innerHTML+=`<text x="${r}" y="${o}" text-anchor="left" font-size="${i}">${s}</text>`}drawBorder(){this.cellGroup.innerHTML+=`<rect x="${this.opts.margin}" y="${this.opts.margin}" width="${this.opts.width}" height="${this.opts.height}" stroke="${this.opts.outerBorderColour}" stroke-width="${this.opts.outerBorderWidth}" fill="none">`}drawQuestions(){let t=`<ol id="jxword-questions-across-${this.uid}" class="jxword-questions-list">`;this.opts.data.across.forEach((e=>{t+=this.drawQuestion(e)})),document.querySelector(`#jxword-question-across-${this.uid}`).innerHTML+=t;let e=`<ol id="jxword-questions-down-${this.uid}" class="jxword-questions-list">`;this.opts.data.down.forEach((t=>{e+=this.drawQuestion(t)})),document.querySelector(`#jxword-question-down-${this.uid}`).innerHTML+=e}drawQuestion(t){return`<li class="jxword-questions-list-item" id="jxword-question-across-${t.num}-${this.uid}" data-q="${t.num}"><span class="jxword-questions-list-item-num">${t.num.replace(/^\D/,"")}</span><span class="jxword-questions-list-item-question">${t.question}</span></li>`}showOverlay(t="paused"){document.querySelector(".jxword-paused").style.display="none",document.querySelector(".jxword-complete_overlay").style.display="none",document.querySelector(".jxword-meta_overlay").style.display="none","paused"===t?document.querySelector(".jxword-paused").style.display="block":"complete"===t?document.querySelector(".jxword-complete_overlay").style.display="block":"meta"===t&&(document.querySelector(".jxword-meta_overlay").style.display="block"),document.querySelector(`#jxword-overlay-${this.uid}`).classList.add("jxword-overlay-show"),document.querySelector(`#jxword-overlay-${this.uid}`).classList.remove("jxword-overlay-hide")}hideOverlay(){document.querySelector(`#jxword-overlay-${this.uid}`).classList.add("jxword-overlay-hide"),document.querySelector(`#jxword-overlay-${this.uid}`).classList.remove("jxword-overlay-show")}checkOverlay(){this.is_paused?this.showOverlay("paused"):this.hideOverlay()}setState(){this.state.direction=0,this.state.complete=!1,this.state.hints=!1,this.state.time_taken=0,this.state.graph=new Array(this.opts.cols).fill("").map((()=>new Array(this.opts.rows).fill("")));for(let t=0;t<this.opts.cols;t++)for(let e=0;e<this.opts.rows;e++)"#"===this.grid[t][e]&&(this.state.graph[t][e]="#");this.state.hash=this.calcHash(this.state.graph),this.state.scalarDown=[];let t=0;for(let e of this.down_questions){this.state.scalarDown.push({col:e.col,row:e.row,letter:"",startOfWord:!0,index:t++,q:e.num,correct:!1});for(let s=1;s<e.data.answer.length;s++)this.state.scalarDown.push({col:e.col,row:e.row+s,letter:"",startOfWord:!1,index:t++,q:e.num,correct:!1})}this.debug&&console.log(this.state.scalarDown),this.state.scalarAcross=[],t=0;for(let e of this.across_questions){this.state.scalarAcross.push({col:e.col,row:e.row,letter:"",startOfWord:!0,index:t++,q:e.num,correct:!1});for(let s=1;s<e.data.answer.length;s++)this.state.scalarAcross.push({col:e.col+s,row:e.row,letter:"",startOfWord:!1,index:t++,q:e.num,correct:!1})}this.debug&&console.log(this.state.scalarAcross),this.state.currentCell=[this.state.scalarAcross[0].col,this.state.scalarAcross[0].row],this.state.correctGrid=new Array(this.opts.cols).fill(!1).map((()=>new Array(this.opts.rows).fill(!1))),this.markCells(),this.state.progress=0,this.state.quartile=0}saveState(){this.debug&&console.log("Saving State"),window.localStorage.setItem(this.storageName,JSON.stringify(this.state))}restoreState(){const t=window.localStorage.getItem(this.storageName);if(t){this.state=JSON.parse(t);for(let t=0;t<this.opts.rows;t++)for(let e=0;e<this.opts.cols;e++){let s=this.state.graph[e][t];"#"!==s&&this.drawLetter(s,e,t)}this.markCells(),this.setAutocheck(),this.stateRestored=!0,this.debug&&console.log("State Restored")}else this.setState()}calcHash(t){let e="";for(let s=0;s<this.opts.rows;s++)for(let i=0;i<this.opts.cols;i++)e+=t[i][s];let s,i=0;for(let t=0;t<e.length;t++)s=e.charCodeAt(t),i=(i<<5)-i+s,i|=0;return i}markCells(){document.querySelectorAll(".jxword-cell-rect.is-letter").forEach((t=>{t.setAttribute("fill",this.opts.backgroundColour),t.setAttribute("tabindex",-1)}));let t=document.querySelector(`#jxword-cell-${this.uid}-${this.state.currentCell[0]}-${this.state.currentCell[1]} > rect`);t.setAttribute("fill",this.opts.selectCellColour),t.setAttribute("tabindex",1);let e=null;if(this.state.direction){for(let t=this.state.currentCell[1]+1;t<this.opts.rows&&(e=document.querySelector(`#jxword-cell-${this.uid}-${this.state.currentCell[0]}-${t} > rect`),!e.classList.contains("is-blank"));t++)e.setAttribute("fill",this.opts.selectWordColour);for(let t=this.state.currentCell[1]-1;t>=0&&(e=document.querySelector(`#jxword-cell-${this.uid}-${this.state.currentCell[0]}-${t} > rect`),!e.classList.contains("is-blank"));t--)e.setAttribute("fill",this.opts.selectWordColour)}else{for(let t=this.state.currentCell[0]+1;t<this.opts.cols&&(e=document.querySelector(`#jxword-cell-${this.uid}-${t}-${this.state.currentCell[1]} > rect`),!e.classList.contains("is-blank"));t++)e.setAttribute("fill",this.opts.selectWordColour);for(let t=this.state.currentCell[0]-1;t>=0&&(e=document.querySelector(`#jxword-cell-${this.uid}-${t}-${this.state.currentCell[1]} > rect`),!e.classList.contains("is-blank"));t--)e.setAttribute("fill",this.opts.selectWordColour)}this.highlightQuestion(this.state.currentCell[0],this.state.currentCell[1]),this.saveState()}registerActions(){const t=this;document.addEventListener("visibilitychange",this.visibilityChanged.bind(this));let e=document.querySelectorAll("rect.is-letter");for(let t of e)t.addEventListener("click",this.catchCellClick.bind(this));document.addEventListener("keydown",this.catchKeyPress.bind(this)),document.querySelector(`#jxword-arrow-forward-${this.uid}`).addEventListener("click",this.moveToNextWord.bind(this)),document.querySelector(`#jxword-arrow-back-${this.uid}`).addEventListener("click",this.moveToPreviousWord.bind(this)),document.querySelectorAll(".jxword-reset").forEach((e=>e.addEventListener("click",t.reset.bind(t)))),document.querySelector(`#jxword-meta-${this.uid}`).addEventListener("click",this.showMeta.bind(this)),document.querySelector(`#jxword-autocheck-${this.uid}`).addEventListener("click",this.toggleAutocheck.bind(this)),document.querySelector(`#jxword-check_word-${this.uid}`).addEventListener("click",this.checkWord.bind(this)),document.querySelector(`#jxword-check_square-${this.uid}`).addEventListener("click",this.checkSquare.bind(this)),document.querySelector(`#jxword-check_puzzle-${this.uid}`).addEventListener("click",this.checkPuzzle.bind(this)),document.querySelector(`#jxword-single-question-${this.uid}`).addEventListener("click",this.changeDirection.bind(this));const s=document.querySelectorAll(".jxword-key");for(let t of s)this.debug&&console.log(t),t.addEventListener("click",this.keyClick.bind(this));document.querySelector(`#jxword-pause-${this.uid}`).addEventListener("click",this.pause.bind(this)),document.querySelector(`#jxword-overlay-resume-${this.uid}`).addEventListener("click",this.play.bind(this)),document.querySelectorAll(".jxword-close-overlay").forEach((e=>e.addEventListener("click",t.hideOverlay.bind(t)))),document.querySelector(`#jxword-print_blank-${this.uid}`).addEventListener("click",this.printBlank.bind(this)),document.querySelector(`#jxword-print_filled-${this.uid}`).addEventListener("click",this.printFilled.bind(this))}visibilityChanged(){"hidden"===document.visibilityState?this.is_hidden=!0:"visible"===document.visibilityState&&(this.is_hidden=!1)}pause(){this.debug&&console.log("Pause"),this.is_paused?(this.is_paused=!1,document.querySelector(`#jxword-pause-${this.uid} > .jxword-pause-text`).innerHTML="Pause",document.querySelector(`#jxword-pause-${this.uid}`).classList.remove("jxword-play"),this.containerElement.dispatchEvent(new CustomEvent("jxword:resume",{detail:this.state}))):(this.is_paused=!0,document.querySelector(`#jxword-pause-${this.uid} > .jxword-pause-text`).innerHTML="Play",document.querySelector(`#jxword-pause-${this.uid}`).classList.add("jxword-play"),this.containerElement.dispatchEvent(new CustomEvent("jxword:pause",{detail:this.state}))),this.checkOverlay()}play(){this.debug&&console.log("Play"),this.is_paused&&(this.is_paused=!1,document.querySelector(`#jxword-pause-${this.uid} > .jxword-pause-text`).innerHTML="Pause",document.querySelector(`#jxword-pause-${this.uid}`).classList.remove("jxword-play"),this.containerElement.dispatchEvent(new CustomEvent("jxword:resume",{detail:this.state}))),this.checkOverlay()}showMeta(t){t.preventDefault(),this.showOverlay("meta"),this.closeMenu()}printBlank(t){t.preventDefault(),this.closeMenu();const e=document.querySelector(`#jxword-svg-${this.uid}`).cloneNode(!0),s=e.querySelectorAll(".jxword-letter");for(let t of s)t.remove();this.print(e)}printFilled(t){t.preventDefault(),this.closeMenu();const e=document.querySelector(`#jxword-svg-${this.uid}`);this.print(e)}print(t){const e=t.outerHTML.replace(/fill="#f7f457"/g,'fill="#ffffff"').replace(/fill="#9ce0fb"/g,'fill="#ffffff"'),s=document.querySelector(`#jxword-questions-across-${this.uid}`).outerHTML,i=document.querySelector(`#jxword-questions-down-${this.uid}`).outerHTML;let r=window.open();r.document.write(`<html><head><title>${this.opts.data.meta.Title}</title>`),r.document.write("<style>\n            .svg-container {\n                height: 35em;\n                display:block;\n            }\n            .jxword-svg {\n                height: 100%;\n                width: 100%;\n            }\n            .jxword-questions-list {\n                list-style: none;\n                line-height: 1.5;\n                font-size: 12px;\n                padding-left: 0px;\n                display: flex;\n                flex-direction: column;\n                margin-right: 20px;\n            }\n            .jxword-questions-list-item-num {\n                margin-right: 5px;\n                text-align: right;\n                width: 25px;\n                min-width: 25px;\n                font-weight: bold;\n            }\n            .questions {\n                display: flex;\n                flex-direction: row;\n                flex-wrap: wrap;\n            }\n        </style>"),r.document.write(`<div class="svg-container">${e}</div>`),r.document.write('<div class="questions">\n'),r.document.write(`<div><h4>Across</h4>\n${s}</div>`),r.document.write(`<div><h4>Down</h4>\n${i}</div>`),r.document.write("</div>"),r.document.close(),r.focus(),r.print(),r.close()}catchCellClick(t){const e=Number(t.target.dataset.col),s=Number(t.target.dataset.row);if(e===this.state.currentCell[0]&&s===this.state.currentCell[1])this.changeDirection();else{this.state.currentCell[0]=e,this.state.currentCell[1]=s;this.getWord(this.state.direction,e,s)||this.changeDirection()}this.markCells(),this.showIOSKeyboard()}moveToNextCell(){let t;t=this.state.direction?this.state.scalarDown:this.state.scalarAcross;const e=t.findIndex((t=>t.col===this.state.currentCell[0]&&t.row===this.state.currentCell[1]));e<t.length-1?(this.state.currentCell[0]=t[e+1].col,this.state.currentCell[1]=t[e+1].row):(this.state.currentCell[0]=t[0].col,this.state.currentCell[1]=t[0].row),this.markCells()}typeLetter(t){if(!0===this.state.correctGrid[this.state.currentCell[0]][this.state.currentCell[1]])return void this.moveToNextCell();const e=this.state.graph[this.state.currentCell[0]][this.state.currentCell[1]];this.state.graph[this.state.currentCell[0]][this.state.currentCell[1]]=t,this.setScalars(t,this.state.currentCell[0],this.state.currentCell[1]),this.drawLetter(t,this.state.currentCell[0],this.state.currentCell[1]),this.checkWin(),e?this.moveToNextCell():this.moveToNext()}catchKeyPress(t){const e=t.keyCode;if(t.metaKey)return;const s=e>64&&e<91;if(!this.is_paused)if(s&&!this.state.complete){const e=t.key.toUpperCase();this.typeLetter(e)}else 8===e?(t.preventDefault(),this.state.complete||this.delete()):32==e?(t.preventDefault(),this.moveToNext()):9===e||13===e?(t.preventDefault(),t.shiftKey?this.moveToPreviousWord():this.moveToNextWord()):37===e?(t.preventDefault(),this.moveLeft()):38===e?(t.preventDefault(),this.moveUp()):39===e?(t.preventDefault(),this.moveRight()):40===e&&(t.preventDefault(),this.moveDown())}moveLeft(){if(this.state.direction)this.state.direction=0,this.setAria();else{let t=this.state.scalarAcross,e=t.find((t=>t.col===this.state.currentCell[0]&&t.row===this.state.currentCell[1]));if(e){let s=e.index;null!==s&&(t[s-1]?(this.state.currentCell[0]=t[s-1].col,this.state.currentCell[1]=t[s-1].row):(this.state.currentCell[0]=t[t.length-1].col,this.state.currentCell[1]=t[t.length-1].row))}else{let t=this.state.currentCell[0];for(;t>0;)if(t--,"#"!==this.state.graph[t][this.state.currentCell[1]]){this.state.currentCell[0]=t;break}}}this.markCells()}moveUp(){if(this.state.direction){let t=this.state.scalarDown,e=t.find((t=>t.col===this.state.currentCell[0]&&t.row===this.state.currentCell[1]));if(e){let s=e.index;null!==s&&(t[s-1]?(this.state.currentCell[0]=t[s-1].col,this.state.currentCell[1]=t[s-1].row):(this.state.currentCell[0]=t[t.length-1].col,this.state.currentCell[1]=t[t.length-1].row))}else{let t=this.state.currentCell[1];for(;t>0;)if(t--,"#"!==this.state.graph[this.state.currentCell[0]][t]){this.state.currentCell[1]=t;break}}}else this.state.direction=1,this.setAria();this.markCells()}moveRight(){if(this.state.direction)this.state.direction=0,this.setAria();else{let t=this.state.scalarAcross,e=t.find((t=>t.col===this.state.currentCell[0]&&t.row===this.state.currentCell[1]));if(e){let s=e.index;null!==s&&(t[s+1]?(this.state.currentCell[0]=t[s+1].col,this.state.currentCell[1]=t[s+1].row):(this.state.currentCell[0]=t[0].col,this.state.currentCell[1]=t[0].row))}else{let t=this.state.currentCell[0];for(;t<this.opts.rows-1;)if(t++,"#"!==this.state.graph[t][this.state.currentCell[1]]){this.state.currentCell[0]=t;break}}}this.markCells()}moveDown(){if(this.state.direction){let t=this.state.scalarDown,e=t.find((t=>t.col===this.state.currentCell[0]&&t.row===this.state.currentCell[1]));if(e){let s=e.index;null!==s&&(t[s+1]?(this.state.currentCell[0]=t[s+1].col,this.state.currentCell[1]=t[s+1].row):(this.state.currentCell[0]=t[0].col,this.state.currentCell[1]=t[0].row))}else{let t=this.state.currentCell[1];for(;t<this.opts.cols-1;)if(t++,"#"!==this.state.graph[this.state.currentCell[0]][t]){this.state.currentCell[1]=t;break}}}else this.state.direction=1,this.setAria();this.markCells()}setScalars(t,e,s){let i=this.state.scalarAcross.find((t=>t.col===e&&t.row===s));i&&(i.letter=t);let r=this.state.scalarDown.find((t=>t.col===e&&t.row===s));r&&(r.letter=t),this.state.autocheck&&t===this.grid[e][s]&&(r&&(r.correct=!0),i&&(i.correct=!0),this.state.correctGrid[e][s]=!0)}moveToNext(){let t=null,e=null,s=null;this.state.direction?(e=this.state.scalarDown,s=this.state.scalarAcross):(e=this.state.scalarAcross,s=this.state.scalarDown);for(let s=e.find((t=>t.col===this.state.currentCell[0]&&t.row===this.state.currentCell[1])).index+1;s<e.length;s++)if(""===e[s].letter){t=e[s];break}if(t)this.state.currentCell[0]=t.col,this.state.currentCell[1]=t.row;else{const t=s.find((t=>""===t.letter));t&&(this.state.currentCell[0]=t.col,this.state.currentCell[1]=t.row,this.changeDirection())}this.markCells()}moveToPreviousLetter(){let t=null;t=this.state.direction?this.state.scalarDown:this.state.scalarAcross;for(let e=t.find((t=>t.col===this.state.currentCell[0]&&t.row===this.state.currentCell[1])).index-1;e>=0;e--)if("#"!==t[e].letter){this.state.currentCell[0]=t[e].col,this.state.currentCell[1]=t[e].row;break}this.markCells()}delete(){this.state.correctGrid[this.state.currentCell[0]][this.state.currentCell[1]]?this.moveToPreviousLetter():!this.state.graph[this.state.currentCell[0]][this.state.currentCell[1]]&&(this.moveToPreviousLetter(),this.state.correctGrid[this.state.currentCell[0]][this.state.currentCell[1]])||(this.drawLetter("",this.state.currentCell[0],this.state.currentCell[1]),this.state.graph[this.state.currentCell[0]][this.state.currentCell[1]]="",this.setScalars("",this.state.currentCell[0],this.state.currentCell[1]),this.saveState(),this.calculateComplete())}moveToNextWord(){let t=null,e=null,s=null;this.state.direction?(e=this.state.scalarDown,s=this.state.scalarAcross):(e=this.state.scalarAcross,s=this.state.scalarDown);let i=e.find((t=>t.col===this.state.currentCell[0]&&t.row===this.state.currentCell[1]));if(i){for(let s=i.index+1;s<e.length;s++)if(e[s].startOfWord){t=e[s];break}if(t&&""!==t.letter)for(let s=t.index+1;s<e.length;s++)if(""===e[s].letter){t=e[s];break}if(t)this.state.currentCell[0]=t.col,this.state.currentCell[1]=t.row;else{const t=s.find((t=>""===t.letter));t&&(this.state.currentCell[0]=t.col,this.state.currentCell[1]=t.row,this.changeDirection())}this.markCells()}}findStartOfCurrentWord(){let t;t=this.state.direction?this.state.scalarDown:this.state.scalarAcross;let e=null;for(let s=t.find((t=>t.col===this.state.currentCell[0]&&t.row===this.state.currentCell[1])).index;s>=0;s--)if(t[s].startOfWord){e=t[s];break}return e}moveToPreviousWord(){let t=null,e=null,s=null;this.state.direction?(e=this.state.scalarDown,s=this.state.scalarAcross):(e=this.state.scalarAcross,s=this.state.scalarDown);let i=this.startOfCurrentWord(),r=null;if(i)for(let t=i.index-1;t>=0;t--)if(""===e[t].letter){r=e[t];break}let o=null;if(r)for(let t=r.index;t>=0;t--)if(e[t].startOfWord){o=e[t];break}if(o)for(let s=o.index;s<e.length;s++)if(""===e[s].letter){t=e[s];break}if(t)this.state.currentCell[0]=t.col,this.state.currentCell[1]=t.row;else{const t=function(t,e){for(let s=t.length-1;s>=0;--s){const i=t[s];if(e(i))return i}}(s,(t=>""===t.letter));if(t){let e=null;for(let i=t.index;i>=0;i--)if(s[i].startOfWord){e=s[i];break}this.state.currentCell[0]=e.col,this.state.currentCell[1]=e.row,this.changeDirection()}}this.markCells()}setFocus(){document.querySelector(".jxword-cell-rect").focus(),this.showIOSKeyboard()}checkWin(){let t=!0;for(let e=0;e<this.grid.length;e++)for(let s=0;s<this.grid[e].length;s++){if("#"===this.grid[e][s])continue;let i=this.state.scalarAcross.find((t=>t.row==s&&t.col==e)),r=this.state.scalarDown.find((t=>t.row==s&&t.col==e));this.grid[e][s]===this.state.graph[e][s]?(i&&(i.correct=!0),r&&(r.correct=!0)):(i&&(i.correct=!1),r&&(r.correct=!1),t=!1)}this.calculateComplete(),t&&this.displayWin()}displayWin(){document.querySelector(".jxword-overlay-title").innerHTML="You Win!",this.drawShare(),this.showOverlay("complete"),this.state.complete=!0,this.audio&&this.audio.play(),this.containerElement.dispatchEvent(new CustomEvent("jxword:complete",{detail:this.state})),console.log("Fireworks!");new x(document.querySelector(".jxword-overlay-content"),{acceleration:1,traceSpeed:3}).start()}highlightQuestion(t,e){let s=null,i=null,r=null;if(this.state.direction?(i=this.state.scalarDown.find((s=>s.col===t&&s.row===e)),s="D",r=this.opts.data.down):(i=this.state.scalarAcross.find((s=>s.col===t&&s.row===e)),s="A",r=this.opts.data.across),!i)return;let o=i.q;var n=document.querySelectorAll(".jxword-questions-list-item.active");[].forEach.call(n,(function(t){t.classList.remove("active")}));const a=document.querySelector(`#jxword-question-across-${s}${o}-${this.uid}`);if(!a)return;a.classList.add("active"),this.debug&&console.log({questionEl:a}),this.debug&&console.log(`#jxword-question-${s}-${this.uid}`),this.ensureVisibility(a,a.parentElement.parentElement);let l=r.find((t=>t.num===`${s}${i.q}`));document.querySelector(".jxword-single-question").innerHTML=`${l.question}`}ensureVisibility(t,e){const s=t.getBoundingClientRect(),i=e.getBoundingClientRect();s.bottom>i.bottom&&t.scrollIntoView(!1),s.top<i.top&&t.scrollIntoView(!0)}listenQuestions(){const t=document.querySelectorAll(".jxword-questions-list-item");for(let e of t)e.addEventListener("click",this.clickQuestion.bind(this))}clickQuestion(t){const e=t.currentTarget.dataset.q,s=e[0],i=Number(e.substring(1));let r=null;"A"===s?(r=this.state.scalarAcross,this.state.direction=0,this.setAria()):(r=this.state.scalarDown,this.state.direction=1,this.setAria());for(let t of r)if(t.q===i){let e=r.filter((t=>t.q===i&&""===t.letter));e.length?(this.state.currentCell[0]=e[0].col,this.state.currentCell[1]=e[0].row):(this.state.currentCell[0]=t.col,this.state.currentCell[1]=t.row);break}this.markCells()}setAria(){let t=t=>t.match(/[.?]$/)?t:`${t}.`,e=null,s=null,i=null;this.state.direction?(e=this.state.scalarDown,s="D",i=this.opts.data.down):(e=this.state.scalarAcross,s="A",i=this.opts.data.across);let r=1;for(let n of e){n.startOfWord&&(r=1);let e=i.find((t=>t.num===`${s}${n.q}`));if(!e)continue;let a=e.question.length,l=`${e.num}. ${t(e.question)} ${a} letters, ${o=r,1===o?"1st":2===o?"2nd":3===o?"3rd":`${o}th`} letter.`;r++,document.querySelector(`#jxword-cell-${this.uid}-${n.col}-${n.row} > .jxword-cell-rect`).setAttribute("aria-label",l)}var o}reset(t){t.preventDefault();const e=this.state.cheated;this.setState(),this.state.cheated=e,this.saveState(),this.restoreState(),this.hideOverlay(),this.closeMenu(),this.containerElement.dispatchEvent(new CustomEvent("jxword:reset",{detail:this.state}))}changeDirection(){this.getWord(!this.state.direction,this.state.currentCell[0],this.state.currentCell[1])&&(this.state.direction=!this.state.direction,this.markCells(),this.setAria())}getWord(t,e,s){let i=null;return i=t?this.state.scalarDown.find((t=>e===t.col&&s===t.row)):this.state.scalarAcross.find((t=>e===t.col&&s===t.row)),i}keyClick(t){t.preventDefault();let e=t.target.dataset.key;this.debug&&console.log({letter:e}),"BACKSPACE"===e?this.delete():this.typeLetter(e)}checkTile(t,e){"#"!==this.grid[t][e]&&(this.state.correctGrid[t][e]||this.grid[t][e]===this.state.graph[t][e]&&(this.state.correctGrid[t][e]=!0,this.drawLetter(this.grid[t][e],t,e)))}checkSquare(t){t.preventDefault(),this.checkTile(this.state.currentCell[0],this.state.currentCell[1]),this.state.cheated=!0,this.saveState(),this.closeMenu()}checkWord(t){t.preventDefault();let e="";e=this.state.direction?this.state.scalarDown:this.state.scalarAcross;let s=this.findStartOfCurrentWord();this.checkTile(s.col,s.row);let i=s.index+1;for(;e[i]&&!e[i].startOfWord;)this.checkTile(e[i].col,e[i].row),i++;this.state.cheated=!0,this.saveState(),this.closeMenu()}checkPuzzle(t){t&&t.preventDefault();for(let t=0;t<this.state.correctGrid.length;t++)for(let e=0;e<this.state.correctGrid[t].length;e++)this.checkTile(t,e);t&&(this.state.cheated=!0,this.saveState(),this.closeMenu())}setAutocheck(){this.state.autocheck?(document.querySelector(`#jxword-autocheck-${this.uid} > li`).innerHTML="Autocheck &check;",this.checkPuzzle()):document.querySelector(`#jxword-autocheck-${this.uid} > li`).innerHTML="Autocheck"}toggleAutocheck(t){t.preventDefault(),this.state.autocheck=!this.state.autocheck,this.state.autocheck&&(this.checkPuzzle(),this.state.cheated=!0,this.containerElement.dispatchEvent(new CustomEvent("jxword:cheat",{detail:this.state}))),this.setAutocheck(),this.saveState(),this.closeMenu()}closeMenu(){const t=document.querySelector(".jxword-menu-toggle input:checked");t&&(t.checked=!1)}calculateComplete(){let t=0,e=0;for(let s=0;s<this.opts.cols;s++)for(let i=0;i<this.opts.rows;i++)"#"!==this.state.graph[s][i]&&(e++,this.state.graph[s][i]&&t++);const s=Math.floor(t/e*100);this.state.progress=s,this.state.quartile=Math.floor(s/25),this.state.quartile>this.last_quartile&&(this.containerElement.dispatchEvent(new CustomEvent("jxword:progress",{detail:this.state})),this.last_quartile=this.state.quartile)}isKeyboardShowing(){return window.innerWidth<=480}setupIOSKeyboard(){if(this.isKeyboardShowing())return;const t=document.createElement("input");t.setAttribute("type","text"),t.setAttribute("id","hiddenIOSInput"),t.setAttribute("autocorrect","off"),t.setAttribute("autocapitalize","off"),t.setAttribute("spellcheck","false");const e=window.scrollY;t.setAttribute("style",`position: absolute; top: ${e}px; left: 0; opacity: 0; width: 0; height: 0; z-index: -100;`);let s=e;t.addEventListener("keydown",(()=>{s=window.scrollY})),t.addEventListener("keyup",(()=>{window.scrollTo(0,s)})),this.containerElement.appendChild(t)}showIOSKeyboard(){const t=window.scrollY,e=document.getElementById("hiddenIOSInput");e&&(e.style.visibility="visible",e.style.top=`${t}px`,e.style.position="absolute",e.focus(),e.style.visibility="hidden",window.scrollTo(0,t))}copyToClipboard(t){const e=t.currentTarget.dataset.text;navigator.clipboard.writeText(decodeURIComponent(e))}};var f=s(483),y=s.n(f);const g=window.gtag;function j(t){const e=document.querySelector(t);e?(e.addEventListener("jxword:load",b),e.addEventListener("jxword:cheat",C),e.addEventListener("jxword:complete",$),e.addEventListener("jxword:reset",S),e.addEventListener("jxword:progress",q),e.addEventListener("jxword:pause",A),e.addEventListener("jxword:resume",L)):console.error("Container not found!")}function k(t,e={}){"function"==typeof g?g("event",t,e):console.log(`gtag not found: ${t}`,e)}function b(t){k("crossword_load",{engagement_time_msec:1e3*t.detail.time_taken})}function C(t){k("crossword_cheat",{engagement_time_msec:1e3*t.detail.time_taken})}function $(t){k("crossword_complete",{engagement_time_msec:1e3*t.detail.time_taken})}function S(t){k("crossword_reset",{engagement_time_msec:1e3*t.detail.time_taken})}function q(t){console.log(t.detail),k("crossword_progress",{engagement_time_msec:1e3*t.detail.time_taken,progress:t.detail.progress,quartile:t.detail.quartile})}function A(t){k("crossword_pause",{engagement_time_msec:1e3*t.detail.time_taken})}function L(t){k("crossword_resume",{engagement_time_msec:1e3*t.detail.time_taken})}window.add_crossword=async function(t,e,s=!1){if(!t)return;const i=atob(t),r=await y()(i);window.jxword=new v({container:`#${e}`,data:r,debug:s}),window.jxword.events=new j(`#${e}`)}})()})();