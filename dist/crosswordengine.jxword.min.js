(()=>{var t={258:(t,e,s)=>{"use strict";s.r(e)},483:t=>{t.exports=function(t){function e(t){let e=[];const s=t.split("\n").filter((t=>t&&"\n"!==t)),i=/(^.\d*)\.\s(.*)\s~\s(.*)/;for(let t=0;t<s.length;t++){if(!s[t].trim())continue;const r=s[t].match(i);if(4!==r.length)throw`Could not parse question ${s[t]}`;const o=r[2].replace(/\\/g,"");e[t]={num:r[1],question:o,answer:r[3]}}return e}return function(t){let s=t.split(/^$^$/gm).filter((t=>"\n"!==t));if(s.length>4){s=t.split(/\r\n\r\n/g).filter((t=>t.trim()));for(let t=0;t<s.length;t++)s[t]=s[t].replace(/\r\n/g,"\n")}if(4!==s.length)throw`Too many parts - expected 4, found ${s.length}`;const i=s[0],r=s[1],o=s[2],l=s[3],a=function(t){const e=t.split("\n").filter((t=>t&&"\n"!==t));let s={};return e.forEach((t=>{const e=t.split(": ");s[e[0]]=e[1]})),s}(i),n=function(t){let e=[];const s=t.split("\n").filter((t=>t&&"\n"!==t));for(let t=0;t<s.length;t++)e[t]=s[t].split("");return e}(r);return{meta:a,grid:n,across:e(o),down:e(l),rawGrid:r,rawAcross:o,rawDown:l,rawMeta:i}}(t)}}},e={};function s(i){var r=e[i];if(void 0!==r)return r.exports;var o=e[i]={exports:{}};return t[i](o,o.exports,s),o.exports}s.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return s.d(e,{a:e}),e},s.d=(t,e)=>{for(var i in e)s.o(e,i)&&!s.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),s.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{"use strict";const t=class{constructor(t){if(console.log("JXWord, a crossword system by Jason Norwood-Young <jason@10layer.com>"),!t.container)throw"'container' required";if(!t.data)throw"'data' required";this.opts=Object.assign({width:500,height:500,outerBorderWidth:1.5,innerBorderWidth:1,margin:3,outerBorderColour:"black",innerBorderColour:"black",fillColour:"black",cols:t.data.grid.length,rows:t.data.grid[0].length,fontRatio:.7,numRatio:.33,selectCellColour:"#f7f457",selectWordColour:"#9ce0fb",backgroundColour:"white",debug:!1,restoreState:!1},t),this.uid=+new Date,this.state={time_taken:0,autocheck:!1,cheated:!1},this.across_questions=[],this.down_questions=[],this.is_hidden=!1,this.is_paused=!1,document.addEventListener("DOMContentLoaded",this.onLoad.bind(this))}onLoad(){if(this.containerElement=document.querySelector(this.opts.container),!this.containerElement)throw`Could not find ${this.opts.container}`;this.totalWidth=this.opts.width+2*this.opts.margin,this.totalHeight=this.opts.height+2*this.opts.margin,this.cellWidth=this.opts.width/this.opts.cols,this.cellHeight=this.opts.height/this.opts.rows,this.fontSize=this.cellWidth*this.opts.fontRatio,this.grid=[],this.grid=this.opts.data.grid[0].map(((t,e)=>this.opts.data.grid.map((t=>t[e])))),this.hash=this.calcHash(this.grid),this.storageName=`jxword-${Math.abs(this.hash)}`,this.drawLayout(),this.drawGrid(),this.drawBorder(),this.drawNumbers(),this.drawQuestions(),this.restoreState(),this.setAria(),this.registerActions(),this.setFocus(),this.listenQuestions(),this.setTimer(),this.drawTimer(),this.checkOverlay()}setTimer(){setInterval((()=>{this.is_hidden||this.is_paused||this.state.complete||(this.state.time_taken||(this.state.time_taken=0),this.state.time_taken++,this.saveState(),this.drawTimer())}).bind(this),1e3)}drawLayout(){this.containerElement.innerHTML=`\n            <div class="jxword-container" id="jxword-container-${this.uid}">\n                <div id="jxword-overlay-${this.uid}" class="jxword-overlay jxword-overlay-hidden">\n                    <div class="jxword-overlay-content">\n                        <div id="jxword-paused-${this.uid}" class="jxword-paused">\n                            <div class="jxword-overlay-title">\n                                Your Game is Currently Paused\n                            </div>\n                            <div id="jxword-overlay-resume-${this.uid}" class="jxword-overlay-button">\n                                Resume\n                            </div>\n                        </div>\n                        <div id="jxword-complete_overlay-${this.uid}" class="jxword-complete_overlay">\n                            <div class="jxword-overlay-title">\n                                Congratulations! You've Won!\n                            </div>\n                            <div id="jxword-overlay-restart-${this.uid}" class="jxword-overlay-button jxword-reset">\n                                Restart\n                            </div>\n                            <div class="jxword-overlay-button jxword-close-overlay">\n                                Close\n                            </div>\n                        </div>\n                        <div id="jxword-meta_overlay-${this.uid}" class="jxword-meta_overlay">\n                            <div class="jxword-overlay-title">\n                                ${this.opts.data.meta.Title}\n                            </div>\n                            <div class="jxword-overlay-text">\n                                <ul>\n                                    ${Object.keys(this.opts.data.meta).map((t=>"Title"===t?"":`<li>${t}: ${this.opts.data.meta[t]}</li>`)).join("\n")}\n                                </ul>\n                            </div>\n                            <div class="jxword-overlay-button jxword-close-overlay">\n                                Close\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="jxword-play-area">\n                    <div class="jxword-grid-container">\n                    <div class="jxword-header">\n                    <nav class="jxword-controls" role="navigation">\n                        <div class="jxword-menu-toggle">\n                            <input type="checkbox" />\n                            <span class="jxword-hamberder"></span>\n                            <span class="jxword-hamberder"></span>\n                            <span class="jxword-hamberder"></span>\n                            <ul class="jxword-menu">\n                                <a href="#" aria-label="About This Puzzle" class="jxword-button" id="jxword-meta-${this.uid}"><li>About This Puzzle</li></a>\n                                <li class="jxword-menu-break"><hr></li>\n                                <a href="#" aria-label="Toggle Autocheck" class="jxword-button" id="jxword-autocheck-${this.uid}"><li>Autocheck</li></a>\n                                <a href="#" aria-label="Check Square" class="jxword-button" id="jxword-check_square-${this.uid}"><li>Check Square</li></a>\n                                <a href="#" aria-label="Check Puzzle" class="jxword-button" id="jxword-check_word-${this.uid}"><li>Check Word</li></a>\n                                <a href="#" aria-label="Check Puzzle" class="jxword-button" id="jxword-check_puzzle-${this.uid}"><li>Check Puzzle</li></a>\n                                <li class="jxword-menu-break"><hr></li>\n                                <a href="#" aria-label="Reset Puzzle" class="jxword-button jxword-reset" id="jxword-reset-${this.uid}"><li>Reset</li></a>\n                            </ul>\n                        </div>\n                    </nav>\n                    <div id="jxword-pause-${this.uid}" class="jxword-pause">\n                        <span class="jxword-pause-text jxword-sr-only">Pause</span>\n                    </div> \n                    <div id="jxword-timer-${this.uid}" class="jxword-timer"></div>\n                </div>\n                        <div class="jxword-svg-container">\n                            <svg id='jxword-svg-${this.uid}' class='jxword-svg' viewBox="0 0 ${this.totalWidth} ${this.totalHeight}">\n                                <g class="cell-group" id='jxword-g-container-${this.uid}'></g>\n                            </svg>\n                        </div>\n                        <div class="jxword-single-question-container jxword-mobile-only">\n                            <div class="jxword-arrow jxword-arrow-back" id="jxword-arrow-back-${this.uid}">&lang;</div>\n                            <div class="jxword-single-question" id="jxword-single-question-${this.uid}"></div>\n                            <div class="jxword-arrow jxword-arrow-forward" id="jxword-arrow-forward-${this.uid}">&rang;</div>\n                        </div>\n                        <div class="jxword-keyboard jxword-mobile-only">\n                            <div class="jxword-keyboard-row">\n                                <div class="jxword-key" data-key="Q">Q</div>\n                                <div class="jxword-key" data-key="W">W</div>\n                                <div class="jxword-key" data-key="E">E</div>\n                                <div class="jxword-key" data-key="R">R</div>\n                                <div class="jxword-key" data-key="T">T</div>\n                                <div class="jxword-key" data-key="Y">Y</div>\n                                <div class="jxword-key" data-key="U">U</div>\n                                <div class="jxword-key" data-key="I">I</div>\n                                <div class="jxword-key" data-key="O">O</div>\n                                <div class="jxword-key" data-key="P">P</div>\n                            </div>\n                            <div class="jxword-keyboard-row">\n                                <div class="jxword-key" data-key="A">A</div>\n                                <div class="jxword-key" data-key="S">S</div>\n                                <div class="jxword-key" data-key="D">D</div>\n                                <div class="jxword-key" data-key="F">F</div>\n                                <div class="jxword-key" data-key="G">G</div>\n                                <div class="jxword-key" data-key="H">H</div>\n                                <div class="jxword-key" data-key="J">J</div>\n                                <div class="jxword-key" data-key="K">K</div>\n                                <div class="jxword-key" data-key="L">L</div>\n                            </div>\n                            <div class="jxword-keyboard-row">\n                                <div class="jxword-key" data-key="Z">Z</div>\n                                <div class="jxword-key" data-key="X">X</div>\n                                <div class="jxword-key" data-key="C">C</div>\n                                <div class="jxword-key" data-key="V">V</div>\n                                <div class="jxword-key" data-key="B">B</div>\n                                <div class="jxword-key" data-key="N">N</div>\n                                <div class="jxword-key" data-key="M">M</div>\n                                <div class="jxword-key jxword-key-backspace" data-key="BACKSPACE">&lArr;</div>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="jxword-question-container jxword-desktop-only" id="jxword-question-container-${this.uid}">\n                        <div class="jxword-questions-across" id="jxword-question-across-${this.uid}"><h4>Across</h4></div>\n                        <div class="jxword-questions-down" id="jxword-question-down-${this.uid}"><h4>Down</h4></div>\n                    </div>\n                </div>\n            </div>\n        `,this.svg=document.querySelector(`#jxword-svg-${this.uid}`),this.cellGroup=document.querySelector(`#jxword-g-container-${this.uid}`)}drawGrid(){for(let t=0;t<this.opts.rows;t++)for(let e=0;e<this.opts.cols;e++)this.cellGroup.innerHTML+=this.drawCell(this.grid[e][t],e,t)}drawCell(t,e,s){const i=this.cellWidth*e+this.opts.margin,r=this.cellHeight*s+this.opts.margin,o=this.cellWidth,l=this.cellHeight,a=i+o/2,n=r+l-.1*l;let d=this.opts.backgroundColour,c="is-letter",h="is-letter-container";return"#"==t&&(d=this.opts.fillColour,c="is-blank",h=""),`<g id="jxword-cell-${this.uid}-${e}-${s}" class="jxword-cell ${h}" style="z-index: 20"><rect class="jxword-cell-rect ${c}" role="cell" tabindex="-1" aria-label="" x="${i}" y="${r}" width="${o}" height="${l}" stroke="${this.opts.innerBorderColour}" stroke-width="${this.opts.innerBorderWidth}" fill="${d}" data-col="${e}" data-row="${s}" contenteditable="true"></rect><text id="jxword-letter-${this.uid}-${e}-${s}" x="${a}" y="${n}" text-anchor="middle" font-size="${this.fontSize}" width="${o}"></text></g>`}drawLetter(t,e,s){const i=document.querySelector(`#jxword-letter-${this.uid}-${e}-${s}`);this.state.correctGrid[e][s]?i.classList.add("jxword-letter-is-correct"):i.classList.remove("jxword-letter-is-correct");const r=document.createTextNode(t);for(;i.firstChild;)i.removeChild(i.lastChild);i.appendChild(r)}drawTimer(){var t,e,s,i,r;document.querySelector(`#jxword-timer-${this.uid}`).innerHTML=`<span id="jxword-timer-text-${this.uid}">${t=this.state.time_taken,e=parseInt(t,10),s=Math.floor(e/3600),i=Math.floor((e-3600*s)/60),r=e-3600*s-60*i,s<10&&(s="0"+s),i<10&&(i="0"+i),r<10&&(r="0"+r),s+":"+i+":"+r}</span>`}isStartOfAcross(t,e){return 0===t&&"#"!==this.grid[t][e]&&"#"!==this.grid[t+1][e]||"#"!==this.grid[t][e]&&(!!this.grid[t+1]&&(0===t||"#"==this.grid[t-1][e]))}isStartOfDown(t,e){return"#"!==this.grid[t][e]&&(!!this.grid[t][e+1]&&(0===e||"#"==this.grid[t][e-1]))}drawNumbers(){let t=1;for(let e=0;e<this.opts.rows;e++)for(let s=0;s<this.opts.cols;s++){let i=!1;this.isStartOfAcross(s,e)&&s!==this.opts.cols-1&&"#"!==this.grid[s+1][e]&&(i=!0,this.across_questions.push({num:t,col:s,row:e,data:this.opts.data.across.find((e=>e.num===`A${t}`))})),this.isStartOfDown(s,e)&&e!==this.opts.rows-1&&"#"!==this.grid[s][e+1]&&(i=!0,this.down_questions.push({num:t,col:s,row:e,data:this.opts.data.down.find((e=>e.num===`D${t}`))})),i&&this.drawNumber(s,e,t++)}}drawNumber(t,e,s){const i=this.cellWidth*this.opts.numRatio,r=this.cellWidth*t+this.opts.margin+2,o=this.cellHeight*e+this.opts.margin+i;document.querySelector(`#jxword-cell-${this.uid}-${t}-${e}`).innerHTML+=`<text x="${r}" y="${o}" text-anchor="left" font-size="${i}">${s}</text>`}drawBorder(){this.cellGroup.innerHTML+=`<rect x="${this.opts.margin}" y="${this.opts.margin}" width="${this.opts.width}" height="${this.opts.height}" stroke="${this.opts.outerBorderColour}" stroke-width="${this.opts.outerBorderWidth}" fill="none">`}drawQuestions(){let t=`<ol id="jxword-questions-across-${this.uid}" class="jxword-questions-list">`;this.opts.data.across.forEach((e=>{t+=this.drawQuestion(e)})),document.querySelector(`#jxword-question-across-${this.uid}`).innerHTML+=t;let e=`<ol id="jxword-questions-down-${this.uid}" class="jxword-questions-list">`;this.opts.data.down.forEach((t=>{e+=this.drawQuestion(t)})),document.querySelector(`#jxword-question-down-${this.uid}`).innerHTML+=e}drawQuestion(t){return`<li class="jxword-questions-list-item" id="jxword-question-across-${t.num}-${this.uid}" data-q="${t.num}"><span class="jxword-questions-list-item-num">${t.num.replace(/^\D/,"")}</span><span class="jxword-questions-list-item-question">${t.question}</span></li>`}showOverlay(t="paused"){document.querySelector(".jxword-paused").style.display="none",document.querySelector(".jxword-complete_overlay").style.display="none",document.querySelector(".jxword-meta_overlay").style.display="none","paused"===t?document.querySelector(".jxword-paused").style.display="block":"complete"===t?document.querySelector(".jxword-complete_overlay").style.display="block":"meta"===t&&(document.querySelector(".jxword-meta_overlay").style.display="block"),document.querySelector(`#jxword-overlay-${this.uid}`).classList.add("jxword-overlay-show"),document.querySelector(`#jxword-overlay-${this.uid}`).classList.remove("jxword-overlay-hide")}hideOverlay(){document.querySelector(`#jxword-overlay-${this.uid}`).classList.add("jxword-overlay-hide"),document.querySelector(`#jxword-overlay-${this.uid}`).classList.remove("jxword-overlay-show")}checkOverlay(){this.is_paused?this.showOverlay("paused"):this.hideOverlay()}setState(){this.state.direction=0,this.state.complete=!1,this.state.hints=!1,this.state.time_taken=0,this.state.graph=new Array(this.opts.cols).fill("").map((()=>new Array(this.opts.rows).fill("")));for(let t=0;t<this.opts.cols;t++)for(let e=0;e<this.opts.rows;e++)"#"===this.grid[t][e]&&(this.state.graph[t][e]="#");this.state.hash=this.calcHash(this.state.graph),this.state.scalarDown=[];let t=0;for(let e of this.down_questions){this.state.scalarDown.push({col:e.col,row:e.row,letter:"",startOfWord:!0,index:t++,q:e.num,correct:!1});for(let s=1;s<e.data.answer.length;s++)this.state.scalarDown.push({col:e.col,row:e.row+s,letter:"",startOfWord:!1,index:t++,q:e.num,correct:!1})}this.debug&&console.log(this.state.scalarDown),this.state.scalarAcross=[],t=0;for(let e of this.across_questions){this.state.scalarAcross.push({col:e.col,row:e.row,letter:"",startOfWord:!0,index:t++,q:e.num,correct:!1});for(let s=1;s<e.data.answer.length;s++)this.state.scalarAcross.push({col:e.col+s,row:e.row,letter:"",startOfWord:!1,index:t++,q:e.num,correct:!1})}this.debug&&console.log(this.state.scalarAcross),this.state.currentCell=[this.state.scalarAcross[0].col,this.state.scalarAcross[0].row],this.state.correctGrid=new Array(this.opts.cols).fill(!1).map((()=>new Array(this.opts.rows).fill(!1))),this.markCells()}saveState(){this.debug&&console.log("Saving State"),window.localStorage.setItem(this.storageName,JSON.stringify(this.state))}restoreState(){const t=window.localStorage.getItem(this.storageName);if(t){this.state=JSON.parse(t);for(let t=0;t<this.opts.rows;t++)for(let e=0;e<this.opts.cols;e++){let s=this.state.graph[e][t];"#"!==s&&this.drawLetter(s,e,t)}this.markCells(),this.setAutocheck(),this.stateRestored=!0,this.debug&&console.log("State Restored")}else this.setState()}calcHash(t){let e="";for(let s=0;s<this.opts.rows;s++)for(let i=0;i<this.opts.cols;i++)e+=t[i][s];let s,i=0;for(let t=0;t<e.length;t++)s=e.charCodeAt(t),i=(i<<5)-i+s,i|=0;return i}markCells(){document.querySelectorAll(".jxword-cell-rect.is-letter").forEach((t=>{t.setAttribute("fill",this.opts.backgroundColour),t.setAttribute("tabindex",-1)}));let t=document.querySelector(`#jxword-cell-${this.uid}-${this.state.currentCell[0]}-${this.state.currentCell[1]} > rect`);t.setAttribute("fill",this.opts.selectCellColour),t.setAttribute("tabindex",1);let e=null;if(this.state.direction){for(let t=this.state.currentCell[1]+1;t<this.opts.rows&&(e=document.querySelector(`#jxword-cell-${this.uid}-${this.state.currentCell[0]}-${t} > rect`),!e.classList.contains("is-blank"));t++)e.setAttribute("fill",this.opts.selectWordColour);for(let t=this.state.currentCell[1]-1;t>=0&&(e=document.querySelector(`#jxword-cell-${this.uid}-${this.state.currentCell[0]}-${t} > rect`),!e.classList.contains("is-blank"));t--)e.setAttribute("fill",this.opts.selectWordColour)}else{for(let t=this.state.currentCell[0]+1;t<this.opts.cols&&(e=document.querySelector(`#jxword-cell-${this.uid}-${t}-${this.state.currentCell[1]} > rect`),!e.classList.contains("is-blank"));t++)e.setAttribute("fill",this.opts.selectWordColour);for(let t=this.state.currentCell[0]-1;t>=0&&(e=document.querySelector(`#jxword-cell-${this.uid}-${t}-${this.state.currentCell[1]} > rect`),!e.classList.contains("is-blank"));t--)e.setAttribute("fill",this.opts.selectWordColour)}this.highlightQuestion(this.state.currentCell[0],this.state.currentCell[1]),this.saveState()}registerActions(){const t=this;document.addEventListener("visibilitychange",this.visibilityChanged.bind(this));let e=document.querySelectorAll("rect.is-letter");for(let t of e)t.addEventListener("click",this.catchCellClick.bind(this));document.addEventListener("keydown",this.catchKeyPress.bind(this)),document.querySelector(`#jxword-arrow-forward-${this.uid}`).addEventListener("click",this.moveToNextWord.bind(this)),document.querySelector(`#jxword-arrow-back-${this.uid}`).addEventListener("click",this.moveToPreviousWord.bind(this)),document.querySelectorAll(".jxword-reset").forEach((e=>e.addEventListener("click",t.reset.bind(t)))),document.querySelector(`#jxword-meta-${this.uid}`).addEventListener("click",this.showMeta.bind(this)),document.querySelector(`#jxword-autocheck-${this.uid}`).addEventListener("click",this.toggleAutocheck.bind(this)),document.querySelector(`#jxword-check_word-${this.uid}`).addEventListener("click",this.checkWord.bind(this)),document.querySelector(`#jxword-check_square-${this.uid}`).addEventListener("click",this.checkSquare.bind(this)),document.querySelector(`#jxword-check_puzzle-${this.uid}`).addEventListener("click",this.checkPuzzle.bind(this)),document.querySelector(`#jxword-single-question-${this.uid}`).addEventListener("click",this.changeDirection.bind(this));const s=document.querySelectorAll(".jxword-key");for(let t of s)this.debug&&console.log(t),t.addEventListener("click",this.keyClick.bind(this));document.querySelector(`#jxword-pause-${this.uid}`).addEventListener("click",this.pause.bind(this)),document.querySelector(`#jxword-overlay-resume-${this.uid}`).addEventListener("click",this.play.bind(this)),document.querySelectorAll(".jxword-close-overlay").forEach((e=>e.addEventListener("click",t.hideOverlay.bind(t))))}visibilityChanged(t){"hidden"===document.visibilityState?this.is_hidden=!0:"visible"===document.visibilityState&&(this.is_hidden=!1)}pause(){this.debug&&console.log("Pause"),this.is_paused?(this.is_paused=!1,document.querySelector(`#jxword-pause-${this.uid} > .jxword-pause-text`).innerHTML="Pause",document.querySelector(`#jxword-pause-${this.uid}`).classList.remove("jxword-play")):(this.is_paused=!0,document.querySelector(`#jxword-pause-${this.uid} > .jxword-pause-text`).innerHTML="Play",document.querySelector(`#jxword-pause-${this.uid}`).classList.add("jxword-play")),this.checkOverlay()}play(){this.debug&&console.log("Play"),this.is_paused&&(this.is_paused=!1,document.querySelector(`#jxword-pause-${this.uid} > .jxword-pause-text`).innerHTML="Pause",document.querySelector(`#jxword-pause-${this.uid}`).classList.remove("jxword-play")),this.checkOverlay()}showMeta(t){t.preventDefault(),this.showOverlay("meta"),this.closeMenu()}catchCellClick(t){const e=Number(t.target.dataset.col),s=Number(t.target.dataset.row);e===this.state.currentCell[0]&&s===this.state.currentCell[1]?this.changeDirection():(this.state.currentCell[0]=e,this.state.currentCell[1]=s),this.markCells()}moveToNextCell(){let t;t=this.state.direction?this.state.scalarDown:this.state.scalarAcross;const e=t.findIndex((t=>t.col===this.state.currentCell[0]&&t.row===this.state.currentCell[1]));e<t.length-1?(this.state.currentCell[0]=t[e+1].col,this.state.currentCell[1]=t[e+1].row):(this.state.currentCell[0]=t[0].col,this.state.currentCell[1]=t[0].row),this.markCells()}typeLetter(t){if(!0===this.state.correctGrid[this.state.currentCell[0]][this.state.currentCell[1]])return void this.moveToNextCell();const e=this.state.graph[this.state.currentCell[0]][this.state.currentCell[1]];this.state.graph[this.state.currentCell[0]][this.state.currentCell[1]]=t,this.setScalars(t,this.state.currentCell[0],this.state.currentCell[1]),this.drawLetter(t,this.state.currentCell[0],this.state.currentCell[1]),this.checkWin(),e?this.moveToNextCell():this.moveToNext()}catchKeyPress(t){const e=t.keyCode;if(t.metaKey)return;const s=e>64&&e<91;if(!this.is_paused)if(s&&!this.state.complete){const e=t.key.toUpperCase();this.typeLetter(e)}else 8===e?(t.preventDefault(),this.state.complete||this.delete()):32==e?(t.preventDefault(),this.moveToNext()):9===e||13===e?(t.preventDefault(),t.shiftKey?this.moveToPreviousWord():this.moveToNextWord()):37===e?(t.preventDefault(),this.moveLeft()):38===e?(t.preventDefault(),this.moveUp()):39===e?(t.preventDefault(),this.moveRight()):40===e&&(t.preventDefault(),this.moveDown())}moveLeft(){if(this.state.direction)this.state.direction=0,this.setAria();else{let t=this.state.scalarAcross,e=t.find((t=>t.col===this.state.currentCell[0]&&t.row===this.state.currentCell[1]));if(e){let s=e.index;null!==s&&(t[s-1]?(this.state.currentCell[0]=t[s-1].col,this.state.currentCell[1]=t[s-1].row):(this.state.currentCell[0]=t[t.length-1].col,this.state.currentCell[1]=t[t.length-1].row))}else{let t=this.state.currentCell[0];for(;t>0;)if(t--,"#"!==this.state.graph[t][this.state.currentCell[1]]){this.state.currentCell[0]=t;break}}}this.markCells()}moveUp(){if(this.state.direction){let t=this.state.scalarDown,e=t.find((t=>t.col===this.state.currentCell[0]&&t.row===this.state.currentCell[1]));if(e){let s=e.index;null!==s&&(t[s-1]?(this.state.currentCell[0]=t[s-1].col,this.state.currentCell[1]=t[s-1].row):(this.state.currentCell[0]=t[t.length-1].col,this.state.currentCell[1]=t[t.length-1].row))}else{let t=this.state.currentCell[1];for(;t>0;)if(t--,"#"!==this.state.graph[this.state.currentCell[0]][t]){this.state.currentCell[1]=t;break}}}else this.state.direction=1,this.setAria();this.markCells()}moveRight(){if(this.state.direction)this.state.direction=0,this.setAria();else{let t=this.state.scalarAcross,e=t.find((t=>t.col===this.state.currentCell[0]&&t.row===this.state.currentCell[1]));if(e){let s=e.index;null!==s&&(t[s+1]?(this.state.currentCell[0]=t[s+1].col,this.state.currentCell[1]=t[s+1].row):(this.state.currentCell[0]=t[0].col,this.state.currentCell[1]=t[0].row))}else{let t=this.state.currentCell[0];for(;t<this.opts.rows-1;)if(t++,"#"!==this.state.graph[t][this.state.currentCell[1]]){this.state.currentCell[0]=t;break}}}this.markCells()}moveDown(){if(this.state.direction){let t=this.state.scalarDown,e=t.find((t=>t.col===this.state.currentCell[0]&&t.row===this.state.currentCell[1]));if(e){let s=e.index;null!==s&&(t[s+1]?(this.state.currentCell[0]=t[s+1].col,this.state.currentCell[1]=t[s+1].row):(this.state.currentCell[0]=t[0].col,this.state.currentCell[1]=t[0].row))}else{let t=this.state.currentCell[1];for(;t<this.opts.cols-1;)if(t++,"#"!==this.state.graph[this.state.currentCell[0]][t]){this.state.currentCell[1]=t;break}}}else this.state.direction=1,this.setAria();this.markCells()}setScalars(t,e,s){let i=this.state.scalarAcross.find((t=>t.col===e&&t.row===s));i&&(i.letter=t);let r=this.state.scalarDown.find((t=>t.col===e&&t.row===s));r&&(r.letter=t),this.state.autocheck&&t===this.grid[e][s]&&(r&&(r.correct=!0),i&&(i.correct=!0),this.state.correctGrid[e][s]=!0)}moveToNext(){let t=null,e=null,s=null;this.state.direction?(e=this.state.scalarDown,s=this.state.scalarAcross):(e=this.state.scalarAcross,s=this.state.scalarDown);for(let s=e.find((t=>t.col===this.state.currentCell[0]&&t.row===this.state.currentCell[1])).index+1;s<e.length;s++)if(""===e[s].letter){t=e[s];break}if(t)this.state.currentCell[0]=t.col,this.state.currentCell[1]=t.row;else{const t=s.find((t=>""===t.letter));t&&(this.state.currentCell[0]=t.col,this.state.currentCell[1]=t.row,this.changeDirection())}this.markCells()}moveToPreviousLetter(){let t=null;t=this.state.direction?this.state.scalarDown:this.state.scalarAcross;for(let e=t.find((t=>t.col===this.state.currentCell[0]&&t.row===this.state.currentCell[1])).index-1;e>=0;e--)if("#"!==t[e].letter){this.state.currentCell[0]=t[e].col,this.state.currentCell[1]=t[e].row;break}this.markCells()}delete(){this.state.correctGrid[this.state.currentCell[0]][this.state.currentCell[1]]?this.moveToPreviousLetter():!this.state.graph[this.state.currentCell[0]][this.state.currentCell[1]]&&(this.moveToPreviousLetter(),this.state.correctGrid[this.state.currentCell[0]][this.state.currentCell[1]])||(this.drawLetter("",this.state.currentCell[0],this.state.currentCell[1]),this.state.graph[this.state.currentCell[0]][this.state.currentCell[1]]="",this.setScalars("",this.state.currentCell[0],this.state.currentCell[1]),this.saveState())}moveToNextWord(){let t=null,e=null,s=null;this.state.direction?(e=this.state.scalarDown,s=this.state.scalarAcross):(e=this.state.scalarAcross,s=this.state.scalarDown);let i=e.find((t=>t.col===this.state.currentCell[0]&&t.row===this.state.currentCell[1]));if(i){for(let s=i.index+1;s<e.length;s++)if(e[s].startOfWord){t=e[s];break}if(t&&""!==t.letter)for(let s=t.index+1;s<e.length;s++)if(""===e[s].letter){t=e[s];break}if(t)this.state.currentCell[0]=t.col,this.state.currentCell[1]=t.row;else{const t=s.find((t=>""===t.letter));t&&(this.state.currentCell[0]=t.col,this.state.currentCell[1]=t.row,this.changeDirection())}this.markCells()}}findStartOfCurrentWord(){let t;t=this.state.direction?this.state.scalarDown:this.state.scalarAcross;let e=null;for(let s=t.find((t=>t.col===this.state.currentCell[0]&&t.row===this.state.currentCell[1])).index;s>=0;s--)if(t[s].startOfWord){e=t[s];break}return e}moveToPreviousWord(){let t=null,e=null,s=null;this.state.direction?(e=this.state.scalarDown,s=this.state.scalarAcross):(e=this.state.scalarAcross,s=this.state.scalarDown);e.find((t=>t.col===this.state.currentCell[0]&&t.row===this.state.currentCell[1]));let i=this.startOfCurrentWord(),r=null;if(i)for(let t=i.index-1;t>=0;t--)if(""===e[t].letter){r=e[t];break}let o=null;if(r)for(let t=r.index;t>=0;t--)if(e[t].startOfWord){o=e[t];break}if(o)for(let s=o.index;s<e.length;s++)if(""===e[s].letter){t=e[s];break}if(t)this.state.currentCell[0]=t.col,this.state.currentCell[1]=t.row;else{const t=function(t,e){for(let s=t.length-1;s>=0;--s){const i=t[s];if(e(i))return i}}(s,(t=>""===t.letter));if(t){let e=null;for(let i=t.index;i>=0;i--)if(s[i].startOfWord){e=s[i];break}this.state.currentCell[0]=e.col,this.state.currentCell[1]=e.row,this.changeDirection()}}this.markCells()}setFocus(){document.querySelector(".jxword-cell-rect").focus()}checkWin(){let t=!0;for(let e=0;e<this.grid.length;e++)for(let s=0;s<this.grid[e].length;s++){if("#"===this.grid[e][s])continue;let i=this.state.scalarAcross.find((t=>t.row==s&&t.col==e)),r=this.state.scalarDown.find((t=>t.row==s&&t.col==e));this.grid[e][s]===this.state.graph[e][s]?(i&&(i.correct=!0),r&&(r.correct=!0)):(i&&(i.correct=!1),r&&(r.correct=!1),t=!1)}t&&(document.querySelector(".jxword-overlay-title").innerHTML="You Win!",this.showOverlay("complete"),this.state.complete=!0)}highlightQuestion(t,e){let s=null,i=null,r=null;if(this.state.direction?(i=this.state.scalarDown.find((s=>s.col===t&&s.row===e)),s="D",r=this.opts.data.down):(i=this.state.scalarAcross.find((s=>s.col===t&&s.row===e)),s="A",r=this.opts.data.across),!i)return;let o=i.q;var l=document.querySelectorAll(".jxword-questions-list-item.active");[].forEach.call(l,(function(t){t.classList.remove("active")}));const a=document.querySelector(`#jxword-question-across-${s}${o}-${this.uid}`);if(!a)return;a.classList.add("active"),this.debug&&console.log({questionEl:a}),this.debug&&console.log(`#jxword-question-${s}-${this.uid}`),this.ensureVisibility(a,a.parentElement.parentElement);let n=r.find((t=>t.num===`${s}${i.q}`));document.querySelector(".jxword-single-question").innerHTML=`${n.question}`}ensureVisibility(t,e){const s=t.getBoundingClientRect(),i=e.getBoundingClientRect();s.bottom>i.bottom&&t.scrollIntoView(!1),s.top<i.top&&t.scrollIntoView(!0)}listenQuestions(){const t=document.querySelectorAll(".jxword-questions-list-item");for(let e of t)e.addEventListener("click",this.clickQuestion.bind(this))}clickQuestion(t){const e=t.currentTarget.dataset.q,s=e[0],i=Number(e.substring(1));let r=null;"A"===s?(r=this.state.scalarAcross,this.state.direction=0,this.setAria()):(r=this.state.scalarDown,this.state.direction=1,this.setAria());for(let t of r)if(t.q===i){let e=r.filter((t=>t.q===i&&""===t.letter));e.length?(this.state.currentCell[0]=e[0].col,this.state.currentCell[1]=e[0].row):(this.state.currentCell[0]=t.col,this.state.currentCell[1]=t.row);break}this.markCells()}setAria(){let t=t=>t.match(/[\.\?]$/)?t:`${t}.`,e=null,s=null,i=null;this.state.direction?(e=this.state.scalarDown,s="D",i=this.opts.data.down):(e=this.state.scalarAcross,s="A",i=this.opts.data.across);let r=1;for(let l of e){l.startOfWord&&(r=1);let e=i.find((t=>t.num===`${s}${l.q}`));if(!e)continue;let a=e.question.length,n=`${e.num}. ${t(e.question)} ${a} letters, ${o=r,1===o?"1st":2===o?"2nd":3===o?"3rd":`${o}th`} letter.`;r++,document.querySelector(`#jxword-cell-${this.uid}-${l.col}-${l.row} > .jxword-cell-rect`).setAttribute("aria-label",n)}var o}reset(t){t.preventDefault();const e=this.state.cheated;this.setState(),this.state.cheated=e,this.saveState(),this.restoreState(),this.hideOverlay(),this.closeMenu()}changeDirection(){this.state.direction=!this.state.direction,this.markCells(),this.setAria()}keyClick(t){t.preventDefault();let e=t.target.dataset.key;this.debug&&console.log({letter:e}),"BACKSPACE"===e?this.delete():this.typeLetter(e)}checkTile(t,e){"#"!==this.grid[t][e]&&(this.state.correctGrid[t][e]||this.grid[t][e]===this.state.graph[t][e]&&(this.state.correctGrid[t][e]=!0,this.drawLetter(this.grid[t][e],t,e)))}checkSquare(t){t.preventDefault(),this.checkTile(this.state.currentCell[0],this.state.currentCell[1]),this.state.cheated=!0,this.saveState(),this.closeMenu()}checkWord(t){t.preventDefault();let e="";e=this.state.direction?this.state.scalarDown:this.state.scalarAcross;let s=this.findStartOfCurrentWord();this.checkTile(s.col,s.row);let i=s.index+1;for(;e[i]&&!e[i].startOfWord;)console.log(e[i]),this.checkTile(e[i].col,e[i].row),i++;this.state.cheated=!0,this.saveState(),this.closeMenu()}checkPuzzle(t){t&&t.preventDefault();for(let t=0;t<this.state.correctGrid.length;t++)for(let e=0;e<this.state.correctGrid[t].length;e++)this.checkTile(t,e);t&&(this.state.cheated=!0,this.saveState(),this.closeMenu())}setAutocheck(){this.state.autocheck?(document.querySelector(`#jxword-autocheck-${this.uid} > li`).innerHTML="Autocheck &check;",this.checkPuzzle()):document.querySelector(`#jxword-autocheck-${this.uid} > li`).innerHTML="Autocheck"}toggleAutocheck(t){t.preventDefault(),this.state.autocheck=!this.state.autocheck,this.state.autocheck&&(this.checkPuzzle(),this.state.cheated=!0),this.setAutocheck(),this.saveState(),this.closeMenu()}closeMenu(){const t=document.querySelector(".jxword-menu-toggle input:checked");t&&(t.checked=!1)}};var e=s(483),i=s.n(e);s(258),window.add_crossword=async function(e,s,r=!1){if(!e)return;const o=atob(e),l=await i()(o);window.jxword=new t({container:`#${s}`,data:l,debug:r})}})()})();